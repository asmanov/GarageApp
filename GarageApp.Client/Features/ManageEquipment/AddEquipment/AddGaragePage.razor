@page "/add-item"
@inject DatabaseService DatabaseService

<PageTitle>Add model</PageTitle>

<MudBreadcrumbs Items="_items" Separator=">"></MudBreadcrumbs>
@if (_submitSuccessful)
{
    <MudAlert Severity="Severity.Success">Обладнання додане</MudAlert>
}
else if (_errorMessage is not null)
{
    <MudAlert Severity="Severity.Error">@_errorMessage</MudAlert>
}
<GarageForm @ref="_garageForm" OnSubmit="SubmitNewItem" />

@code {
    private readonly List<BreadcrumbItem> _items =
        [
        new("Home", href: "/GarageApp/", icon: Icons.Material.Filled.Home),
        new("Add item", href: null, disabled: true, icon: Icons.Material.Filled.Create)
    ];

    private bool _submitSuccessful;
    private string? _errorMessage;
    private GarageForm _garageForm = default!;

    private async Task SubmitNewItem(Garage item)
    {
        var response = await DatabaseService.Insert<Garage>(item);
        if(response != null)
        {
            _submitSuccessful = true;
        }
        else
        {
            _errorMessage = "Ошибка при добавлении записи";
        }
        _garageForm.ResetForm();
        StateHasChanged();
    }
}
